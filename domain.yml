version: "3.1"

intents:
  - saludo
  - despedida_fin
  - consultar_sintoma
  - consultar_medicamento
  - ubicacion
  - horario
  - hablar_farmaceutico
  - elegir_opcion
  - opcion_consultar_medicamento
  - opcion_ubicacion
  - opcion_horarios
  - opcion_hablar_farmaceutico
  - opciones_menu
  - afirmar
  - negar
  - listar_sintomas
  - solicitar_contacto_farmaceutico
  - stop
  - consultar_medicamento_nombre
  - listar_medicamentos 
  - volver_menu
  - ayuda
  - cancelar
  - otro_medicamento 
  - otro_sintoma    
  - recargar_sintomas
  - recargar_medicamentos 
  - enviar_calificacion   
  - reporte_feedback

entities:
  - sintoma
  - nombre
  - telefono
  - preferencia_contacto
  - motivo
  - medicamento
  - rating

slots:
  sintoma:
    type: text
    mappings:
      - type: from_entity
        entity: sintoma
  nombre:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        conditions:
          - active_loop: contacto_ticket_form
            requested_slot: nombre
  telefono:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        conditions:
          - active_loop: contacto_ticket_form
            requested_slot: telefono
  correo:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        conditions:
          - active_loop: contacto_ticket_form
            requested_slot: correo
  preferencia_contacto:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        conditions:
          - active_loop: contacto_ticket_form
            requested_slot: preferencia_contacto
  motivo:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        conditions:
          - active_loop: contacto_ticket_form
            requested_slot: motivo
  rating:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: rating

forms:
  contacto_ticket_form:
    required_slots:
      - nombre
      - telefono
      - correo
      - preferencia_contacto
      - motivo
  
responses:
  utter_greet:
    - text: "ğŸ‘‹ Â¡Hola! Bienvenido a Farmacias Emanuel."
  
  utter_menu:
    - text: |
        Â¿CÃ³mo puedo ayudarte hoy?
        1ï¸âƒ£ Consultar sÃ­ntoma  
        2ï¸âƒ£ Consultar medicamentos 
        3ï¸âƒ£ Conocer ubicaciÃ³n de la farmacia  
        4ï¸âƒ£ Ver horarios de atenciÃ³n  
        5ï¸âƒ£ Hablar con un farmacÃ©utico  
        Por favor escribe el nÃºmero o nombre de la opciÃ³n deseada.

  utter_ayuda:
    - text: |
        Puedo, ayudar con:
        1ï¸âƒ£ Consultar sÃ­ntoma --> Escribe el sÃ­ntoma que estas padeciendo y te recomendare un medicamento e indicaciones. TambiÃ©n puedes escribir: *sÃ­ntomas* y te mostrare todos los sÃ­ntomas que reconozco.
        2ï¸âƒ£ Consultar medicamentos --> Escribe el nombre del medicamento que quieras consultar y te mostrare su contenido, uso y dÃ³sis ademÃ¡s de informaciÃ³n complementaria. TambiÃ©n puedes escribir: *medicamentos* y te mostrare el catÃ¡logo de medicamento del que dispongo.
        3ï¸âƒ£ Conocer ubicaciÃ³n de la farmacia --> Puedes conocer el lugar donde se ubican nuestras sucursales. 
        4ï¸âƒ£ Ver horarios de atenciÃ³n --> Consulta nuestros horarios de atenciÃ³n en cada sucursal. 
        5ï¸âƒ£ Hablar con un farmacÃ©utico  --> Si quieres una atenciÃ³n personalizada dejanos saber tus datos y te contactaremos lo mÃ¡s pronto posible.
        Escribe el nÃºmero o el nombre de la opciÃ³n, o "volver" para regresar al menÃº..

  utter_ubicacion:
    - text: "ğŸ“ Estamos en Zaculeu Central Zona 9, Huehuetenango"

  utter_horario:
    - text: "ğŸ•’ Horario: Lunes a SÃ¡bado, 8:00 a.m. - 8:00 p.m."

  utter_despedida:
    - text: "Â¡Gracias por visitarnos! ğŸ’Š Que tengas un excelente dÃ­a."

  utter_cancelado:
    - text: "Listo, cancelÃ© la operaciÃ³n en curso y regresÃ© al menÃº."

  utter_solicitar_sintoma:
    - text: "Â¿CuÃ¡l es el sÃ­ntoma que estÃ¡s presentando? (Ej: dolor de cabeza, fiebre, diarrea)"

  utter_solicitar_medicamento:
    - text: "Â¿QuÃ© medicamento deseas consultar?"

  utter_ok_despedida:
    - text: "âœ… Listo. Si necesitas algo mÃ¡s, aquÃ­ estoy."

  utter_mostrar_lista_sintomas:
    - text: |
        ğŸ“‹ Lista de sÃ­ntomas que puedo reconocer:
        ğŸ¤• Dolor:
        â€¢ Dolor de cabeza
        â€¢ Dolor de garganta
        â€¢ Dolor de espalda
        â€¢ Dolor muscular
        â€¢ Dolor de muelas
        ğŸ¤’ Malestar general:
        â€¢ Fiebre
        â€¢ Mareo
        â€¢ NÃ¡useas
        â€¢ Diarrea
        â€¢ Acidez estomacal
        ğŸ¤§ Problemas respiratorios:
        â€¢ CongestiÃ³n nasal
        â€¢ Tos
        ğŸ©¹ Piel y alergias:
        â€¢ Quemadura leve
        â€¢ Urticaria
        ğŸ’ª Otros:
        â€¢ Calambres
        â€¢ Dolor menstrual
        â€¢ EstreÃ±imiento
        â€¢ Dolor de oÃ­do
        Escribe ahora un sÃ­ntoma (por ejemplo: *dolor de espalda*)
      buttons:
        - title: "Ir al menÃº"
          payload: "menÃº"

  utter_mostrar_lista_medicamentos:
    - text: |
        ğŸ“‹ Lista de medicamentos que puedo reconocer:
        â€¢ paracetamol
        â€¢ ibuprofeno
        â€¢ naproxeno 
        â€¢ diclofenaco 
        â€¢ ketorolaco
        â€¢ loratadina
        â€¢ cetirizina
        â€¢ clorfeniramina
        â€¢ omeprazol
        â€¢ famotidina
        â€¢ metoclopramida
        â€¢ domperidona
        â€¢ loperamida
        â€¢ sueros orales
        â€¢ butilescopolamina
        â€¢ simeticona
        â€¢ dextrometorfano
        â€¢ guaifenesina
        â€¢ ambroxol
        â€¢ oximetazolina
        â€¢ clotrimazol
        â€¢ miconazol
        â€¢ hidrocortisona 1% 
        â€¢ peroxido de benzoilo
        â€¢ melatonina
        Escribe ahora un medicamento (por ejemplo: *diclofenaco*)
      buttons:
        - title: "Ir al menÃº"
          payload: "menÃº"

  utter_derivar_farmaceutico:
  - text: "ğŸ” Perfecto, crearÃ© un ticket para que un farmacÃ©utico te contacte. Necesito unos datos breves."

  utter_ask_nombre:
  - text: "Â¿CuÃ¡l es tu nombre completo?"

  utter_ask_telefono:
  - text: "Â¿CuÃ¡l es tu nÃºmero de telÃ©fono?"

  utter_ask_correo:
  - text: "Â¿CuÃ¡l es tu correo electrÃ³nico?."

  utter_ask_preferencia_contacto:
  - text: "Â¿Prefieres que te contacten por llamada, WhatsApp o email?"

  utter_ask_motivo:
  - text: "CuÃ©ntame brevemente el motivo de la consulta para el farmacÃ©utico."

  utter_ticket_enviado:
  - text: "ğŸ“ Â¡Listo! EnviÃ© tu solicitud (ID: {ticket_id}). Te contactaremos por {preferencia_contacto} al {telefono}{cola_correo}."

  utter_pedir_medicamento_nombre:
    - text: "Â¿QuÃ© medicamento deseas consultar?"
    
actions:
  - action_consultar_medicamento
  - action_elegir_opcion
  - action_listar_sintomas
  - validate_contacto_ticket_form
  - action_enviar_ticket_email
  - action_consultar_por_nombre           # â† NUEVO (la lÃ³gica principal)
  - action_listar_medicamentos            # â† NUEVO (muestra la lista)
  - action_pedir_medicamento_nombre
  - action_recargar_sintomas
  - action_recargar_medicamentos
  - action_enviar_calificacion
  - action_reporte_feedback

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true


